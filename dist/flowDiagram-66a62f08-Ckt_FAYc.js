"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const P=require("./flowDb-956e92f1-BjhnHtfa.js"),k=require("./graph-L5sQI78Q.js"),d=require("./index-CvlpYZ1D.js"),C=require("./layout-ChCyWgcE.js"),y=require("./styles-c10674c1-B4uQLICg.js"),dt=require("./line-fE3iCZvo.js");require("./index-B68OGEr0.js");function ht(r){if(!r.ok)throw new Error(r.status+" "+r.statusText);return r.text()}function ut(r,e){return fetch(r,e).then(ht)}function ft(r){return(e,t)=>ut(e,t).then(n=>new DOMParser().parseFromString(n,r))}var pt=ft("image/svg+xml"),G={normal:gt,vee:vt,undirected:wt};function yt(r){G=r}function gt(r,e,t,n){var a=r.append("marker").attr("id",e).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),s=a.append("path").attr("d","M 0 0 L 10 5 L 0 10 z").style("stroke-width",1).style("stroke-dasharray","1,0");y.applyStyle(s,t[n+"Style"]),t[n+"Class"]&&s.attr("class",t[n+"Class"])}function vt(r,e,t,n){var a=r.append("marker").attr("id",e).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),s=a.append("path").attr("d","M 0 0 L 10 5 L 0 10 L 4 5 z").style("stroke-width",1).style("stroke-dasharray","1,0");y.applyStyle(s,t[n+"Style"]),t[n+"Class"]&&s.attr("class",t[n+"Class"])}function wt(r,e,t,n){var a=r.append("marker").attr("id",e).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto"),s=a.append("path").attr("d","M 0 5 L 10 5").style("stroke-width",1).style("stroke-dasharray","1,0");y.applyStyle(s,t[n+"Style"]),t[n+"Class"]&&s.attr("class",t[n+"Class"])}function xt(r,e){var t=r;return t.node().appendChild(e.label),y.applyStyle(t,e.labelStyle),t}function mt(r,e){for(var t=r.append("text"),n=bt(e.label).split(`
`),a=0;a<n.length;a++)t.append("tspan").attr("xml:space","preserve").attr("dy","1em").attr("x","1").text(n[a]);return y.applyStyle(t,e.labelStyle),t}function bt(r){for(var e="",t=!1,n,a=0;a<r.length;++a)if(n=r[a],t){switch(n){case"n":e+=`
`;break;default:e+=n}t=!1}else n==="\\"?t=!0:e+=n;return e}function H(r,e,t){var n=e.label,a=r.append("g");e.labelType==="svg"?xt(a,e):typeof n!="string"||e.labelType==="html"?y.addHtmlLabel(a,e):mt(a,e);var s=a.node().getBBox(),i;switch(t){case"top":i=-e.height/2;break;case"bottom":i=e.height/2-s.height;break;default:i=-s.height/2}return a.attr("transform","translate("+-s.width/2+","+i+")"),a}var U=function(r,e){var t=e.nodes().filter(function(s){return y.isSubgraph(e,s)}),n=r.selectAll("g.cluster").data(t,function(s){return s});y.applyTransition(n.exit(),e).style("opacity",0).remove();var a=n.enter().append("g").attr("class","cluster").attr("id",function(s){var i=e.node(s);return i.id}).style("opacity",0).each(function(s){var i=e.node(s),l=d.select(this);d.select(this).append("rect");var c=l.append("g").attr("class","label");H(c,i,i.clusterLabelPos)});return n=n.merge(a),n=y.applyTransition(n,e).style("opacity",1),n.selectAll("rect").each(function(s){var i=e.node(s),l=d.select(this);y.applyStyle(l,i.style)}),n};function kt(r){U=r}let W=function(r,e){var t=r.selectAll("g.edgeLabel").data(e.edges(),function(a){return y.edgeToId(a)}).classed("update",!0);t.exit().remove(),t.enter().append("g").classed("edgeLabel",!0).style("opacity",0),t=r.selectAll("g.edgeLabel"),t.each(function(a){var s=d.select(this);s.select(".label").remove();var i=e.edge(a),l=H(s,e.edge(a),0).classed("label",!0),c=l.node().getBBox();i.labelId&&l.attr("id",i.labelId),k.has(i,"width")||(i.width=c.width),k.has(i,"height")||(i.height=c.height)});var n;return t.exit?n=t.exit():n=t.selectAll(null),y.applyTransition(n,e).style("opacity",0).remove(),t};function St(r){W=r}function F(r,e){return r.intersect(e)}var V=function(r,e,t){var n=r.selectAll("g.edgePath").data(e.edges(),function(i){return y.edgeToId(i)}).classed("update",!0),a=Ct(n,e);At(n,e);var s=n.merge!==void 0?n.merge(a):n;return y.applyTransition(s,e).style("opacity",1),s.each(function(i){var l=d.select(this),c=e.edge(i);c.elem=this,c.id&&l.attr("id",c.id),y.applyClass(l,c.class,(l.classed("update")?"update ":"")+"edgePath")}),s.selectAll("path.path").each(function(i){var l=e.edge(i);l.arrowheadId=C.uniqueId("arrowhead");var c=d.select(this).attr("marker-end",function(){return"url("+Lt(location.href,l.arrowheadId)+")"}).style("fill","none");y.applyTransition(c,e).attr("d",function(h){return Et(e,h)}),y.applyStyle(c,l.style)}),s.selectAll("defs *").remove(),s.selectAll("defs").each(function(i){var l=e.edge(i),c=t[l.arrowhead];c(d.select(this),l.arrowheadId,l,"arrowhead")}),s};function Tt(r){V=r}function Lt(r,e){var t=r.split("#")[0];return t+"#"+e}function Et(r,e){var t=r.edge(e),n=r.node(e.v),a=r.node(e.w),s=t.points.slice(1,t.points.length-1);return s.unshift(F(n,s[0])),s.push(F(a,s[s.length-1])),K(t,s)}function K(r,e){var t=(dt.line||pt.line)().x(function(n){return n.x}).y(function(n){return n.y});return(t.curve||t.interpolate)(r.curve),t(e)}function _t(r){var e=r.getBBox(),t=r.ownerSVGElement.getScreenCTM().inverse().multiply(r.getScreenCTM()).translate(e.width/2,e.height/2);return{x:t.e,y:t.f}}function Ct(r,e){var t=r.enter().append("g").attr("class","edgePath").style("opacity",0);return t.append("path").attr("class","path").attr("d",function(n){var a=e.edge(n),s=e.node(n.v).elem,i=C.range(a.points.length).map(function(){return _t(s)});return K(a,i)}),t.append("defs"),t}function At(r,e){var t=r.exit();y.applyTransition(t,e).style("opacity",0).remove()}var q=function(r,e,t){var n=e.nodes().filter(function(i){return!y.isSubgraph(e,i)}),a=r.selectAll("g.node").data(n,function(i){return i}).classed("update",!0);a.exit().remove(),a.enter().append("g").attr("class","node").style("opacity",0),a=r.selectAll("g.node"),a.each(function(i){var l=e.node(i),c=d.select(this);y.applyClass(c,l.class,(c.classed("update")?"update ":"")+"node"),c.select("g.label").remove();var h=c.append("g").attr("class","label"),o=H(h,l),v=t[l.shape],u=C.pick(o.node().getBBox(),"width","height");l.elem=this,l.id&&c.attr("id",l.id),l.labelId&&h.attr("id",l.labelId),k.has(l,"width")&&(u.width=l.width),k.has(l,"height")&&(u.height=l.height),u.width+=l.paddingLeft+l.paddingRight,u.height+=l.paddingTop+l.paddingBottom,h.attr("transform","translate("+(l.paddingLeft-l.paddingRight)/2+","+(l.paddingTop-l.paddingBottom)/2+")");var f=d.select(this);f.select(".label-container").remove();var g=v(f,u,l).classed("label-container",!0);y.applyStyle(g,l.style);var x=g.node().getBBox();l.width=x.width,l.height=x.height});var s;return a.exit?s=a.exit():s=a.selectAll(null),y.applyTransition(s,e).style("opacity",0).remove(),a};function Nt(r){q=r}function It(r,e){var t=r.filter(function(){return!d.select(this).classed("update")});function n(a){var s=e.node(a);return"translate("+s.x+","+s.y+")"}t.attr("transform",n),y.applyTransition(r,e).style("opacity",1).attr("transform",n),y.applyTransition(t.selectAll("rect"),e).attr("width",function(a){return e.node(a).width}).attr("height",function(a){return e.node(a).height}).attr("x",function(a){var s=e.node(a);return-s.width/2}).attr("y",function(a){var s=e.node(a);return-s.height/2})}function Mt(r,e){var t=r.filter(function(){return!d.select(this).classed("update")});function n(a){var s=e.edge(a);return k.has(s,"x")?"translate("+s.x+","+s.y+")":""}t.attr("transform",n),y.applyTransition(r,e).style("opacity",1).attr("transform",n)}function Bt(r,e){var t=r.filter(function(){return!d.select(this).classed("update")});function n(a){var s=e.node(a);return"translate("+s.x+","+s.y+")"}t.attr("transform",n),y.applyTransition(r,e).style("opacity",1).attr("transform",n)}function Q(r,e,t,n){var a=r.x,s=r.y,i=a-n.x,l=s-n.y,c=Math.sqrt(e*e*l*l+t*t*i*i),h=Math.abs(e*t*i/c);n.x<a&&(h=-h);var o=Math.abs(e*t*l/c);return n.y<s&&(o=-o),{x:a+h,y:s+o}}function Dt(r,e,t){return Q(r,e,e,t)}function Pt(r,e,t,n){var a,s,i,l,c,h,o,v,u,f,g,x,p,w,T;if(a=e.y-r.y,i=r.x-e.x,c=e.x*r.y-r.x*e.y,u=a*t.x+i*t.y+c,f=a*n.x+i*n.y+c,!(u!==0&&f!==0&&X(u,f))&&(s=n.y-t.y,l=t.x-n.x,h=n.x*t.y-t.x*n.y,o=s*r.x+l*r.y+h,v=s*e.x+l*e.y+h,!(o!==0&&v!==0&&X(o,v))&&(g=a*l-s*i,g!==0)))return x=Math.abs(g/2),p=i*h-l*c,w=p<0?(p-x)/g:(p+x)/g,p=s*c-a*h,T=p<0?(p-x)/g:(p+x)/g,{x:w,y:T}}function X(r,e){return r*e>0}function _(r,e,t){var n=r.x,a=r.y,s=[],i=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY;e.forEach(function(g){i=Math.min(i,g.x),l=Math.min(l,g.y)});for(var c=n-r.width/2-i,h=a-r.height/2-l,o=0;o<e.length;o++){var v=e[o],u=e[o<e.length-1?o+1:0],f=Pt(r,t,{x:c+v.x,y:h+v.y},{x:c+u.x,y:h+u.y});f&&s.push(f)}return s.length?(s.length>1&&s.sort(function(g,x){var p=g.x-t.x,w=g.y-t.y,T=Math.sqrt(p*p+w*w),I=x.x-t.x,E=x.y-t.y,R=Math.sqrt(I*I+E*E);return T<R?-1:T===R?0:1}),s[0]):(console.log("NO INTERSECTION FOUND, RETURN NODE CENTER",r),r)}function Y(r,e){var t=r.x,n=r.y,a=e.x-t,s=e.y-n,i=r.width/2,l=r.height/2,c,h;return Math.abs(s)*i>Math.abs(a)*l?(s<0&&(l=-l),c=s===0?0:l*a/s,h=l):(a<0&&(i=-i),c=i,h=a===0?0:i*s/a),{x:t+c,y:n+h}}var z={rect:$t,ellipse:Gt,circle:Ut,diamond:Wt};function Rt(r){z=r}function $t(r,e,t){var n=r.insert("rect",":first-child").attr("rx",t.rx).attr("ry",t.ry).attr("x",-e.width/2).attr("y",-e.height/2).attr("width",e.width).attr("height",e.height);return t.intersect=function(a){return Y(t,a)},n}function Gt(r,e,t){var n=e.width/2,a=e.height/2,s=r.insert("ellipse",":first-child").attr("x",-e.width/2).attr("y",-e.height/2).attr("rx",n).attr("ry",a);return t.intersect=function(i){return Q(t,n,a,i)},s}function Ut(r,e,t){var n=Math.max(e.width,e.height)/2,a=r.insert("circle",":first-child").attr("x",-e.width/2).attr("y",-e.height/2).attr("r",n);return t.intersect=function(s){return Dt(t,n,s)},a}function Wt(r,e,t){var n=e.width*Math.SQRT2/2,a=e.height*Math.SQRT2/2,s=[{x:0,y:-a},{x:-n,y:0},{x:0,y:a},{x:n,y:0}],i=r.insert("polygon",":first-child").attr("points",s.map(function(l){return l.x+","+l.y}).join(" "));return t.intersect=function(l){return _(t,s,l)},i}function Vt(){var r=function(e,t){Ht(t);var n=B(e,"output"),a=B(n,"clusters"),s=B(n,"edgePaths"),i=W(B(n,"edgeLabels"),t),l=q(B(n,"nodes"),t,z);C.layout(t),Bt(l,t),Mt(i,t),V(s,t,G);var c=U(a,t);It(c,t),Yt(t)};return r.createNodes=function(e){return arguments.length?(Nt(e),r):q},r.createClusters=function(e){return arguments.length?(kt(e),r):U},r.createEdgeLabels=function(e){return arguments.length?(St(e),r):W},r.createEdgePaths=function(e){return arguments.length?(Tt(e),r):V},r.shapes=function(e){return arguments.length?(Rt(e),r):z},r.arrows=function(e){return arguments.length?(yt(e),r):G},r}var qt={paddingLeft:10,paddingRight:10,paddingTop:10,paddingBottom:10,rx:0,ry:0,shape:"rect"},zt={arrowhead:"normal",curve:d.curveLinear};function Ht(r){r.nodes().forEach(function(e){var t=r.node(e);!k.has(t,"label")&&!r.children(e).length&&(t.label=e),k.has(t,"paddingX")&&C.defaults(t,{paddingLeft:t.paddingX,paddingRight:t.paddingX}),k.has(t,"paddingY")&&C.defaults(t,{paddingTop:t.paddingY,paddingBottom:t.paddingY}),k.has(t,"padding")&&C.defaults(t,{paddingLeft:t.padding,paddingRight:t.padding,paddingTop:t.padding,paddingBottom:t.padding}),C.defaults(t,qt),k.forEach(["paddingLeft","paddingRight","paddingTop","paddingBottom"],function(n){t[n]=Number(t[n])}),k.has(t,"width")&&(t._prevWidth=t.width),k.has(t,"height")&&(t._prevHeight=t.height)}),r.edges().forEach(function(e){var t=r.edge(e);k.has(t,"label")||(t.label=""),C.defaults(t,zt)})}function Yt(r){k.forEach(r.nodes(),function(e){var t=r.node(e);k.has(t,"_prevWidth")?t.width=t._prevWidth:delete t.width,k.has(t,"_prevHeight")?t.height=t._prevHeight:delete t.height,delete t._prevWidth,delete t._prevHeight})}function B(r,e){var t=r.select("g."+e);return t.empty()&&(t=r.append("g").attr("class",e)),t}function J(r,e,t){const n=e.width,a=e.height,s=(n+a)*.9,i=[{x:s/2,y:0},{x:s,y:-s/2},{x:s/2,y:-s},{x:0,y:-s/2}],l=A(r,s,s,i);return t.intersect=function(c){return _(t,i,c)},l}function Z(r,e,t){const a=e.height,s=a/4,i=e.width+2*s,l=[{x:s,y:0},{x:i-s,y:0},{x:i,y:-a/2},{x:i-s,y:-a},{x:s,y:-a},{x:0,y:-a/2}],c=A(r,i,a,l);return t.intersect=function(h){return _(t,l,h)},c}function O(r,e,t){const n=e.width,a=e.height,s=[{x:-a/2,y:0},{x:n,y:0},{x:n,y:-a},{x:-a/2,y:-a},{x:0,y:-a/2}],i=A(r,n,a,s);return t.intersect=function(l){return _(t,s,l)},i}function j(r,e,t){const n=e.width,a=e.height,s=[{x:-2*a/6,y:0},{x:n-a/6,y:0},{x:n+2*a/6,y:-a},{x:a/6,y:-a}],i=A(r,n,a,s);return t.intersect=function(l){return _(t,s,l)},i}function tt(r,e,t){const n=e.width,a=e.height,s=[{x:2*a/6,y:0},{x:n+a/6,y:0},{x:n-2*a/6,y:-a},{x:-a/6,y:-a}],i=A(r,n,a,s);return t.intersect=function(l){return _(t,s,l)},i}function et(r,e,t){const n=e.width,a=e.height,s=[{x:-2*a/6,y:0},{x:n+2*a/6,y:0},{x:n-a/6,y:-a},{x:a/6,y:-a}],i=A(r,n,a,s);return t.intersect=function(l){return _(t,s,l)},i}function rt(r,e,t){const n=e.width,a=e.height,s=[{x:a/6,y:0},{x:n-a/6,y:0},{x:n+2*a/6,y:-a},{x:-2*a/6,y:-a}],i=A(r,n,a,s);return t.intersect=function(l){return _(t,s,l)},i}function at(r,e,t){const n=e.width,a=e.height,s=[{x:0,y:0},{x:n+a/2,y:0},{x:n,y:-a/2},{x:n+a/2,y:-a},{x:0,y:-a}],i=A(r,n,a,s);return t.intersect=function(l){return _(t,s,l)},i}function nt(r,e,t){const n=e.height,a=e.width+n/4,s=r.insert("rect",":first-child").attr("rx",n/2).attr("ry",n/2).attr("x",-a/2).attr("y",-n/2).attr("width",a).attr("height",n);return t.intersect=function(i){return Y(t,i)},s}function st(r,e,t){const n=e.width,a=e.height,s=[{x:0,y:0},{x:n,y:0},{x:n,y:-a},{x:0,y:-a},{x:0,y:0},{x:-8,y:0},{x:n+8,y:0},{x:n+8,y:-a},{x:-8,y:-a},{x:-8,y:0}],i=A(r,n,a,s);return t.intersect=function(l){return _(t,s,l)},i}function it(r,e,t){const n=e.width,a=n/2,s=a/(2.5+n/50),i=e.height+s,l="M 0,"+s+" a "+a+","+s+" 0,0,0 "+n+" 0 a "+a+","+s+" 0,0,0 "+-n+" 0 l 0,"+i+" a "+a+","+s+" 0,0,0 "+n+" 0 l 0,"+-i,c=r.attr("label-offset-y",s).insert("path",":first-child").attr("d",l).attr("transform","translate("+-n/2+","+-(i/2+s)+")");return t.intersect=function(h){const o=Y(t,h),v=o.x-t.x;if(a!=0&&(Math.abs(v)<t.width/2||Math.abs(v)==t.width/2&&Math.abs(o.y-t.y)>t.height/2-s)){let u=s*s*(1-v*v/(a*a));u!=0&&(u=Math.sqrt(u)),u=s-u,h.y-t.y>0&&(u=-u),o.y+=u}return o},c}function Ft(r){r.shapes().question=J,r.shapes().hexagon=Z,r.shapes().stadium=nt,r.shapes().subroutine=st,r.shapes().cylinder=it,r.shapes().rect_left_inv_arrow=O,r.shapes().lean_right=j,r.shapes().lean_left=tt,r.shapes().trapezoid=et,r.shapes().inv_trapezoid=rt,r.shapes().rect_right_inv_arrow=at}function Xt(r){r({question:J}),r({hexagon:Z}),r({stadium:nt}),r({subroutine:st}),r({cylinder:it}),r({rect_left_inv_arrow:O}),r({lean_right:j}),r({lean_left:tt}),r({trapezoid:et}),r({inv_trapezoid:rt}),r({rect_right_inv_arrow:at})}function A(r,e,t,n){return r.insert("polygon",":first-child").attr("points",n.map(function(a){return a.x+","+a.y}).join(" ")).attr("transform","translate("+-e/2+","+t/2+")")}const Kt={addToRender:Ft,addToRenderV2:Xt},lt={},Qt=function(r){const e=Object.keys(r);for(const t of e)lt[t]=r[t]},ot=async function(r,e,t,n,a,s){const i=n?n.select(`[id="${t}"]`):d.select(`[id="${t}"]`),l=a||document,c=Object.keys(r);for(const h of c){const o=r[h];let v="default";o.classes.length>0&&(v=o.classes.join(" "));const u=d.getStylesFromArray(o.styles);let f=o.text!==void 0?o.text:o.id,g;if(d.evaluate(d.getConfig().flowchart.htmlLabels)){const w={label:await d.renderKatex(f.replace(/fa[blrs]?:fa-[\w-]+/g,T=>`<i class='${T.replace(":"," ")}'></i>`),d.getConfig())};g=y.addHtmlLabel(i,w).node(),g.parentNode.removeChild(g)}else{const w=l.createElementNS("http://www.w3.org/2000/svg","text");w.setAttribute("style",u.labelStyle.replace("color:","fill:"));const T=f.split(d.common$1.lineBreakRegex);for(const I of T){const E=l.createElementNS("http://www.w3.org/2000/svg","tspan");E.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),E.setAttribute("dy","1em"),E.setAttribute("x","1"),E.textContent=I,w.appendChild(E)}g=w}let x=0,p="";switch(o.type){case"round":x=5,p="rect";break;case"square":p="rect";break;case"diamond":p="question";break;case"hexagon":p="hexagon";break;case"odd":p="rect_left_inv_arrow";break;case"lean_right":p="lean_right";break;case"lean_left":p="lean_left";break;case"trapezoid":p="trapezoid";break;case"inv_trapezoid":p="inv_trapezoid";break;case"odd_right":p="rect_left_inv_arrow";break;case"circle":p="circle";break;case"ellipse":p="ellipse";break;case"stadium":p="stadium";break;case"subroutine":p="subroutine";break;case"cylinder":p="cylinder";break;case"group":p="rect";break;default:p="rect"}d.log$1.warn("Adding node",o.id,o.domId),e.setNode(s.db.lookUpDomId(o.id),{labelType:"svg",labelStyle:u.labelStyle,shape:p,label:g,rx:x,ry:x,class:v,style:u.style,id:s.db.lookUpDomId(o.id)})}},ct=async function(r,e,t){let n=0,a,s;if(r.defaultStyle!==void 0){const i=d.getStylesFromArray(r.defaultStyle);a=i.style,s=i.labelStyle}for(const i of r){n++;const l="L-"+i.start+"-"+i.end,c="LS-"+i.start,h="LE-"+i.end,o={};i.type==="arrow_open"?o.arrowhead="none":o.arrowhead="normal";let v="",u="";if(i.style!==void 0){const f=d.getStylesFromArray(i.style);v=f.style,u=f.labelStyle}else switch(i.stroke){case"normal":v="fill:none",a!==void 0&&(v=a),s!==void 0&&(u=s);break;case"dotted":v="fill:none;stroke-width:2px;stroke-dasharray:3;";break;case"thick":v=" stroke-width: 3.5px;fill:none";break}o.style=v,o.labelStyle=u,i.interpolate!==void 0?o.curve=d.interpolateToCurve(i.interpolate,d.curveLinear):r.defaultInterpolate!==void 0?o.curve=d.interpolateToCurve(r.defaultInterpolate,d.curveLinear):o.curve=d.interpolateToCurve(lt.curve,d.curveLinear),i.text===void 0?i.style!==void 0&&(o.arrowheadStyle="fill: #333"):(o.arrowheadStyle="fill: #333",o.labelpos="c",d.evaluate(d.getConfig().flowchart.htmlLabels)?(o.labelType="html",o.label=`<span id="L-${l}" class="edgeLabel L-${c}' L-${h}" style="${o.labelStyle}">${await d.renderKatex(i.text.replace(/fa[blrs]?:fa-[\w-]+/g,f=>`<i class='${f.replace(":"," ")}'></i>`),d.getConfig())}</span>`):(o.labelType="text",o.label=i.text.replace(d.common$1.lineBreakRegex,`
`),i.style===void 0&&(o.style=o.style||"stroke: #333; stroke-width: 1.5px;fill:none"),o.labelStyle=o.labelStyle.replace("color:","fill:"))),o.id=l,o.class=c+" "+h,o.minlen=i.length||1,e.setEdge(t.db.lookUpDomId(i.start),t.db.lookUpDomId(i.end),o,n)}},Jt=function(r,e){return d.log$1.info("Extracting classes"),e.db.getClasses()},Zt=async function(r,e,t,n){d.log$1.info("Drawing flowchart");const{securityLevel:a,flowchart:s}=d.getConfig();let i;a==="sandbox"&&(i=d.select("#i"+e));const l=a==="sandbox"?d.select(i.nodes()[0].contentDocument.body):d.select("body"),c=a==="sandbox"?i.nodes()[0].contentDocument:document;let h=n.db.getDirection();h===void 0&&(h="TD");const o=s.nodeSpacing||50,v=s.rankSpacing||50,u=new k.Graph({multigraph:!0,compound:!0}).setGraph({rankdir:h,nodesep:o,ranksep:v,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}});let f;const g=n.db.getSubGraphs();for(let m=g.length-1;m>=0;m--)f=g[m],n.db.addVertex(f.id,f.title,"group",void 0,f.classes);const x=n.db.getVertices();d.log$1.warn("Get vertices",x);const p=n.db.getEdges();let w=0;for(w=g.length-1;w>=0;w--){f=g[w],y.selectAll("cluster").append("text");for(let m=0;m<f.nodes.length;m++)d.log$1.warn("Setting subgraph",f.nodes[m],n.db.lookUpDomId(f.nodes[m]),n.db.lookUpDomId(f.id)),u.setParent(n.db.lookUpDomId(f.nodes[m]),n.db.lookUpDomId(f.id))}await ot(x,u,e,l,c,n),await ct(p,u,n);const T=new Vt;Kt.addToRender(T),T.arrows().none=function(S,L,b,M){const N=S.append("marker").attr("id",L).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 0 0 L 0 0 z");y.applyStyle(N,b[M+"Style"])},T.arrows().normal=function(S,L){S.append("marker").attr("id",L).attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerUnits","strokeWidth").attr("markerWidth",8).attr("markerHeight",6).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowheadPath").style("stroke-width",1).style("stroke-dasharray","1,0")};const I=l.select(`[id="${e}"]`),E=l.select("#"+e+" g");for(T(E,u),E.selectAll("g.node").attr("title",function(){return n.db.getTooltip(this.id)}),n.db.indexNodes("subGraph"+w),w=0;w<g.length;w++)if(f=g[w],f.title!=="undefined"){const m=c.querySelectorAll("#"+e+' [id="'+n.db.lookUpDomId(f.id)+'"] rect'),S=c.querySelectorAll("#"+e+' [id="'+n.db.lookUpDomId(f.id)+'"]'),L=m[0].x.baseVal.value,b=m[0].y.baseVal.value,M=m[0].width.baseVal.value,N=d.select(S[0]).select(".label");N.attr("transform",`translate(${L+M/2}, ${b+14})`),N.attr("id",e+"Text");for(let $=0;$<f.classes.length;$++)S[0].classList.add(f.classes[$])}if(!s.htmlLabels){const m=c.querySelectorAll('[id="'+e+'"] .edgeLabel .label');for(const S of m){const L=S.getBBox(),b=c.createElementNS("http://www.w3.org/2000/svg","rect");b.setAttribute("rx",0),b.setAttribute("ry",0),b.setAttribute("width",L.width),b.setAttribute("height",L.height),S.insertBefore(b,S.firstChild)}}d.setupGraphViewbox$1(u,I,s.diagramPadding,s.useMaxWidth),Object.keys(x).forEach(function(m){const S=x[m];if(S.link){const L=l.select("#"+e+' [id="'+n.db.lookUpDomId(m)+'"]');if(L){const b=c.createElementNS("http://www.w3.org/2000/svg","a");b.setAttributeNS("http://www.w3.org/2000/svg","class",S.classes.join(" ")),b.setAttributeNS("http://www.w3.org/2000/svg","href",S.link),b.setAttributeNS("http://www.w3.org/2000/svg","rel","noopener"),a==="sandbox"?b.setAttributeNS("http://www.w3.org/2000/svg","target","_top"):S.linkTarget&&b.setAttributeNS("http://www.w3.org/2000/svg","target",S.linkTarget);const M=L.insert(function(){return b},":first-child"),D=L.select(".label-container");D&&M.append(function(){return D.node()});const N=L.select(".label");N&&M.append(function(){return N.node()})}}})},Ot={setConf:Qt,addVertices:ot,addEdges:ct,getClasses:Jt,draw:Zt},jt={parser:P.parser$1,db:P.flowDb,renderer:y.flowRendererV2,styles:y.flowStyles,init:r=>{r.flowchart||(r.flowchart={}),r.flowchart.arrowMarkerAbsolute=r.arrowMarkerAbsolute,Ot.setConf(r.flowchart),P.flowDb.clear(),P.flowDb.setGen("gen-1")}};exports.diagram=jt;
//# sourceMappingURL=flowDiagram-66a62f08-Ckt_FAYc.js.map
