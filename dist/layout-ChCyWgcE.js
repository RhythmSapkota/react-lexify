"use strict";const u=require("./graph-L5sQI78Q.js"),k=require("./index-B68OGEr0.js"),w=require("./index-CvlpYZ1D.js");var yn=1/0,Ln=17976931348623157e292;function M(n){if(!n)return n===0?n:0;if(n=k.toNumber(n),n===yn||n===-1/0){var e=n<0?-1:1;return e*Ln}return n===n?n:0}function Nn(n){var e=M(n),r=e%1;return e===e?r?e-r:e:0}function y(n){var e=n==null?0:n.length;return e?u.baseFlatten(n):[]}function In(n){return w.setToString(w.overRest(n,void 0,y),n+"")}var _n=1,Cn=4;function Rn(n){return u.baseClone(n,_n|Cn)}var tn=Object.prototype,Mn=tn.hasOwnProperty,on=w.baseRest(function(n,e){n=Object(n);var r=-1,i=e.length,a=i>2?e[2]:void 0;for(a&&w.isIterateeCall(e[0],e[1],a)&&(i=1);++r<i;)for(var o=e[r],t=w.keysIn(o),f=-1,d=t.length;++f<d;){var c=t[f],s=n[c];(s===void 0||w.eq(s,tn[c])&&!Mn.call(n,c))&&(n[c]=o[c])}return n});function T(n){var e=n==null?0:n.length;return e?n[e-1]:void 0}function Tn(n){return function(e,r,i){var a=Object(e);if(!w.isArrayLike(e)){var o=u.baseIteratee(r);e=u.keys(e),r=function(f){return o(a[f],f,a)}}var t=n(e,r,i);return t>-1?a[o?e[t]:t]:void 0}}var On=Math.max;function Pn(n,e,r){var i=n==null?0:n.length;if(!i)return-1;var a=r==null?0:Nn(r);return a<0&&(a=On(i+a,0)),u.baseFindIndex(n,u.baseIteratee(e),a)}var $=Tn(Pn);function un(n,e){var r=-1,i=w.isArrayLike(n)?Array(n.length):[];return u.baseEach(n,function(a,o,t){i[++r]=e(a,o,t)}),i}function m(n,e){var r=w.isArray(n)?u.arrayMap:un;return r(n,u.baseIteratee(e))}function Fn(n,e){return n==null?n:w.baseFor(n,u.castFunction(e),w.keysIn)}function Sn(n,e){return n&&u.baseForOwn(n,u.castFunction(e))}function An(n,e){return n>e}function fn(n,e){return n<e}function O(n,e){var r={};return e=u.baseIteratee(e),u.baseForOwn(n,function(i,a,o){w.baseAssignValue(r,a,e(i,a,o))}),r}function q(n,e,r){for(var i=-1,a=n.length;++i<a;){var o=n[i],t=e(o);if(t!=null&&(f===void 0?t===t&&!k.isSymbol(t):r(t,f)))var f=t,d=o}return d}function E(n){return n&&n.length?q(n,w.identity,An):void 0}function I(n){return n&&n.length?q(n,w.identity,fn):void 0}function U(n,e){return n&&n.length?q(n,u.baseIteratee(e),fn):void 0}function Gn(n,e,r,i){if(!k.isObject(n))return n;e=u.castPath(e,n);for(var a=-1,o=e.length,t=o-1,f=n;f!=null&&++a<o;){var d=u.toKey(e[a]),c=r;if(d==="__proto__"||d==="constructor"||d==="prototype")return n;if(a!=t){var s=f[d];c=void 0,c===void 0&&(c=k.isObject(s)?s:w.isIndex(e[a+1])?[]:{})}w.assignValue(f,d,c),f=f[d]}return n}function Bn(n,e,r){for(var i=-1,a=e.length,o={};++i<a;){var t=e[i],f=u.baseGet(n,t);r(f,t)&&Gn(o,u.castPath(t,n),f)}return o}function Vn(n,e){var r=n.length;for(n.sort(e);r--;)n[r]=n[r].value;return n}function Yn(n,e){if(n!==e){var r=n!==void 0,i=n===null,a=n===n,o=k.isSymbol(n),t=e!==void 0,f=e===null,d=e===e,c=k.isSymbol(e);if(!f&&!c&&!o&&n>e||o&&t&&d&&!f&&!c||i&&t&&d||!r&&d||!a)return 1;if(!i&&!o&&!c&&n<e||c&&r&&a&&!i&&!o||f&&r&&a||!t&&a||!d)return-1}return 0}function $n(n,e,r){for(var i=-1,a=n.criteria,o=e.criteria,t=a.length,f=r.length;++i<t;){var d=Yn(a[i],o[i]);if(d){if(i>=f)return d;var c=r[i];return d*(c=="desc"?-1:1)}}return n.index-e.index}function qn(n,e,r){e.length?e=u.arrayMap(e,function(o){return w.isArray(o)?function(t){return u.baseGet(t,o.length===1?o[0]:o)}:o}):e=[w.identity];var i=-1;e=u.arrayMap(e,w.baseUnary(u.baseIteratee));var a=un(n,function(o,t,f){var d=u.arrayMap(e,function(c){return c(o)});return{criteria:d,index:++i,value:o}});return Vn(a,function(o,t){return $n(o,t,r)})}function Un(n,e){return Bn(n,e,function(r,i){return u.hasIn(n,i)})}var _=In(function(n,e){return n==null?{}:Un(n,e)}),Dn=Math.ceil,Wn=Math.max;function zn(n,e,r,i){for(var a=-1,o=Wn(Dn((e-n)/(r||1)),0),t=Array(o);o--;)t[++a]=n,n+=r;return t}function Xn(n){return function(e,r,i){return i&&typeof i!="number"&&w.isIterateeCall(e,r,i)&&(r=i=void 0),e=M(e),r===void 0?(r=e,e=0):r=M(r),i=i===void 0?e<r?1:-1:M(i),zn(e,r,i)}}var g=Xn(),R=w.baseRest(function(n,e){if(n==null)return[];var r=e.length;return r>1&&w.isIterateeCall(n,e[0],e[1])?e=[]:r>2&&w.isIterateeCall(e[0],e[1],e[2])&&(e=[e[0]]),qn(n,u.baseFlatten(e),[])}),Hn=0;function P(n){var e=++Hn;return u.toString(n)+e}function jn(n,e,r){for(var i=-1,a=n.length,o=e.length,t={};++i<a;){var f=i<o?e[i]:void 0;r(t,n[i],f)}return t}function Jn(n,e){return jn(n||[],e||[],w.assignValue)}class Kn{constructor(){var e={};e._next=e._prev=e,this._sentinel=e}dequeue(){var e=this._sentinel,r=e._prev;if(r!==e)return H(r),r}enqueue(e){var r=this._sentinel;e._prev&&e._next&&H(e),e._next=r._next,r._next._prev=e,r._next=e,e._prev=r}toString(){for(var e=[],r=this._sentinel,i=r._prev;i!==r;)e.push(JSON.stringify(i,Zn)),i=i._prev;return"["+e.join(", ")+"]"}}function H(n){n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev}function Zn(n,e){if(n!=="_next"&&n!=="_prev")return e}var Qn=w.constant$1(1);function ne(n,e){if(n.nodeCount()<=1)return[];var r=re(n,e||Qn),i=ee(r.graph,r.buckets,r.zeroIdx);return y(m(i,function(a){return n.outEdges(a.v,a.w)}))}function ee(n,e,r){for(var i=[],a=e[e.length-1],o=e[0],t;n.nodeCount();){for(;t=o.dequeue();)S(n,e,r,t);for(;t=a.dequeue();)S(n,e,r,t);if(n.nodeCount()){for(var f=e.length-2;f>0;--f)if(t=e[f].dequeue(),t){i=i.concat(S(n,e,r,t,!0));break}}}return i}function S(n,e,r,i,a){var o=a?[]:void 0;return u.forEach(n.inEdges(i.v),function(t){var f=n.edge(t),d=n.node(t.v);a&&o.push({v:t.v,w:t.w}),d.out-=f,Y(e,r,d)}),u.forEach(n.outEdges(i.v),function(t){var f=n.edge(t),d=t.w,c=n.node(d);c.in-=f,Y(e,r,c)}),n.removeNode(i.v),o}function re(n,e){var r=new u.Graph,i=0,a=0;u.forEach(n.nodes(),function(f){r.setNode(f,{v:f,in:0,out:0})}),u.forEach(n.edges(),function(f){var d=r.edge(f.v,f.w)||0,c=e(f),s=d+c;r.setEdge(f.v,f.w,s),a=Math.max(a,r.node(f.v).out+=c),i=Math.max(i,r.node(f.w).in+=c)});var o=g(a+i+3).map(function(){return new Kn}),t=i+1;return u.forEach(r.nodes(),function(f){Y(o,t,r.node(f))}),{graph:r,buckets:o,zeroIdx:t}}function Y(n,e,r){r.out?r.in?n[r.out-r.in+e].enqueue(r):n[n.length-1].enqueue(r):n[0].enqueue(r)}function ie(n){var e=n.graph().acyclicer==="greedy"?ne(n,r(n)):ae(n);u.forEach(e,function(i){var a=n.edge(i);n.removeEdge(i),a.forwardName=i.name,a.reversed=!0,n.setEdge(i.w,i.v,a,P("rev"))});function r(i){return function(a){return i.edge(a).weight}}}function ae(n){var e=[],r={},i={};function a(o){u.has(i,o)||(i[o]=!0,r[o]=!0,u.forEach(n.outEdges(o),function(t){u.has(r,t.w)?e.push(t):a(t.w)}),delete r[o])}return u.forEach(n.nodes(),a),e}function te(n){u.forEach(n.edges(),function(e){var r=n.edge(e);if(r.reversed){n.removeEdge(e);var i=r.forwardName;delete r.reversed,delete r.forwardName,n.setEdge(e.w,e.v,r,i)}})}function L(n,e,r,i){var a;do a=P(i);while(n.hasNode(a));return r.dummy=e,n.setNode(a,r),a}function oe(n){var e=new u.Graph().setGraph(n.graph());return u.forEach(n.nodes(),function(r){e.setNode(r,n.node(r))}),u.forEach(n.edges(),function(r){var i=e.edge(r.v,r.w)||{weight:0,minlen:1},a=n.edge(r);e.setEdge(r.v,r.w,{weight:i.weight+a.weight,minlen:Math.max(i.minlen,a.minlen)})}),e}function dn(n){var e=new u.Graph({multigraph:n.isMultigraph()}).setGraph(n.graph());return u.forEach(n.nodes(),function(r){n.children(r).length||e.setNode(r,n.node(r))}),u.forEach(n.edges(),function(r){e.setEdge(r,n.edge(r))}),e}function j(n,e){var r=n.x,i=n.y,a=e.x-r,o=e.y-i,t=n.width/2,f=n.height/2;if(!a&&!o)throw new Error("Not possible to find intersection inside of the rectangle");var d,c;return Math.abs(o)*t>Math.abs(a)*f?(o<0&&(f=-f),d=f*a/o,c=f):(a<0&&(t=-t),d=t,c=t*o/a),{x:r+d,y:i+c}}function F(n){var e=m(g(cn(n)+1),function(){return[]});return u.forEach(n.nodes(),function(r){var i=n.node(r),a=i.rank;u.isUndefined(a)||(e[a][i.order]=r)}),e}function ue(n){var e=I(m(n.nodes(),function(r){return n.node(r).rank}));u.forEach(n.nodes(),function(r){var i=n.node(r);u.has(i,"rank")&&(i.rank-=e)})}function fe(n){var e=I(m(n.nodes(),function(o){return n.node(o).rank})),r=[];u.forEach(n.nodes(),function(o){var t=n.node(o).rank-e;r[t]||(r[t]=[]),r[t].push(o)});var i=0,a=n.graph().nodeRankFactor;u.forEach(r,function(o,t){u.isUndefined(o)&&t%a!==0?--i:i&&u.forEach(o,function(f){n.node(f).rank+=i})})}function J(n,e,r,i){var a={width:0,height:0};return arguments.length>=4&&(a.rank=r,a.order=i),L(n,"border",a,e)}function cn(n){return E(m(n.nodes(),function(e){var r=n.node(e).rank;if(!u.isUndefined(r))return r}))}function de(n,e){var r={lhs:[],rhs:[]};return u.forEach(n,function(i){e(i)?r.lhs.push(i):r.rhs.push(i)}),r}function ce(n,e){return e()}function se(n){function e(r){var i=n.children(r),a=n.node(r);if(i.length&&u.forEach(i,e),u.has(a,"minRank")){a.borderLeft=[],a.borderRight=[];for(var o=a.minRank,t=a.maxRank+1;o<t;++o)K(n,"borderLeft","_bl",r,a,o),K(n,"borderRight","_br",r,a,o)}}u.forEach(n.children(),e)}function K(n,e,r,i,a,o){var t={width:0,height:0,rank:o,borderType:e},f=a[e][o-1],d=L(n,"border",t,r);a[e][o]=d,n.setParent(d,i),f&&n.setEdge(f,d,{weight:1})}function he(n){var e=n.graph().rankdir.toLowerCase();(e==="lr"||e==="rl")&&sn(n)}function le(n){var e=n.graph().rankdir.toLowerCase();(e==="bt"||e==="rl")&&ve(n),(e==="lr"||e==="rl")&&(pe(n),sn(n))}function sn(n){u.forEach(n.nodes(),function(e){Z(n.node(e))}),u.forEach(n.edges(),function(e){Z(n.edge(e))})}function Z(n){var e=n.width;n.width=n.height,n.height=e}function ve(n){u.forEach(n.nodes(),function(e){A(n.node(e))}),u.forEach(n.edges(),function(e){var r=n.edge(e);u.forEach(r.points,A),u.has(r,"y")&&A(r)})}function A(n){n.y=-n.y}function pe(n){u.forEach(n.nodes(),function(e){G(n.node(e))}),u.forEach(n.edges(),function(e){var r=n.edge(e);u.forEach(r.points,G),u.has(r,"x")&&G(r)})}function G(n){var e=n.x;n.x=n.y,n.y=e}function we(n){n.graph().dummyChains=[],u.forEach(n.edges(),function(e){me(n,e)})}function me(n,e){var r=e.v,i=n.node(r).rank,a=e.w,o=n.node(a).rank,t=e.name,f=n.edge(e),d=f.labelRank;if(o!==i+1){n.removeEdge(e);var c,s,h;for(h=0,++i;i<o;++h,++i)f.points=[],s={width:0,height:0,edgeLabel:f,edgeObj:e,rank:i},c=L(n,"edge",s,"_d"),i===d&&(s.width=f.width,s.height=f.height,s.dummy="edge-label",s.labelpos=f.labelpos),n.setEdge(r,c,{weight:f.weight},t),h===0&&n.graph().dummyChains.push(c),r=c;n.setEdge(r,a,{weight:f.weight},t)}}function be(n){u.forEach(n.graph().dummyChains,function(e){var r=n.node(e),i=r.edgeLabel,a;for(n.setEdge(r.edgeObj,i);r.dummy;)a=n.successors(e)[0],n.removeNode(e),i.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),e=a,r=n.node(e)})}function D(n){var e={};function r(i){var a=n.node(i);if(u.has(e,i))return a.rank;e[i]=!0;var o=I(m(n.outEdges(i),function(t){return r(t.w)-n.edge(t).minlen}));return(o===Number.POSITIVE_INFINITY||o===void 0||o===null)&&(o=0),a.rank=o}u.forEach(n.sources(),r)}function C(n,e){return n.node(e.w).rank-n.node(e.v).rank-n.edge(e).minlen}function hn(n){var e=new u.Graph({directed:!1}),r=n.nodes()[0],i=n.nodeCount();e.setNode(r,{});for(var a,o;Ee(e,n)<i;)a=ge(e,n),o=e.hasNode(a.v)?C(n,a):-C(n,a),xe(e,n,o);return e}function Ee(n,e){function r(i){u.forEach(e.nodeEdges(i),function(a){var o=a.v,t=i===o?a.w:o;!n.hasNode(t)&&!C(e,a)&&(n.setNode(t,{}),n.setEdge(i,t,{}),r(t))})}return u.forEach(n.nodes(),r),n.nodeCount()}function ge(n,e){return U(e.edges(),function(r){if(n.hasNode(r.v)!==n.hasNode(r.w))return C(e,r)})}function xe(n,e,r){u.forEach(n.nodes(),function(i){e.node(i).rank+=r})}function ke(){}ke.prototype=new Error;function ln(n,e,r){w.isArray(e)||(e=[e]);var i=(n.isDirected()?n.successors:n.neighbors).bind(n),a=[],o={};return u.forEach(e,function(t){if(!n.hasNode(t))throw new Error("Graph does not have node: "+t);vn(n,t,r==="post",o,i,a)}),a}function vn(n,e,r,i,a,o){u.has(i,e)||(i[e]=!0,r||o.push(e),u.forEach(a(e),function(t){vn(n,t,r,i,a,o)}),r&&o.push(e))}function ye(n,e){return ln(n,e,"post")}function Le(n,e){return ln(n,e,"pre")}x.initLowLimValues=z;x.initCutValues=W;x.calcCutValue=pn;x.leaveEdge=mn;x.enterEdge=bn;x.exchangeEdges=En;function x(n){n=oe(n),D(n);var e=hn(n);z(e),W(e,n);for(var r,i;r=mn(e);)i=bn(e,n,r),En(e,n,r,i)}function W(n,e){var r=ye(n,n.nodes());r=r.slice(0,r.length-1),u.forEach(r,function(i){Ne(n,e,i)})}function Ne(n,e,r){var i=n.node(r),a=i.parent;n.edge(r,a).cutvalue=pn(n,e,r)}function pn(n,e,r){var i=n.node(r),a=i.parent,o=!0,t=e.edge(r,a),f=0;return t||(o=!1,t=e.edge(a,r)),f=t.weight,u.forEach(e.nodeEdges(r),function(d){var c=d.v===r,s=c?d.w:d.v;if(s!==a){var h=c===o,l=e.edge(d).weight;if(f+=h?l:-l,_e(n,r,s)){var v=n.edge(r,s).cutvalue;f+=h?-v:v}}}),f}function z(n,e){arguments.length<2&&(e=n.nodes()[0]),wn(n,{},1,e)}function wn(n,e,r,i,a){var o=r,t=n.node(i);return e[i]=!0,u.forEach(n.neighbors(i),function(f){u.has(e,f)||(r=wn(n,e,r,f,i))}),t.low=o,t.lim=r++,a?t.parent=a:delete t.parent,r}function mn(n){return $(n.edges(),function(e){return n.edge(e).cutvalue<0})}function bn(n,e,r){var i=r.v,a=r.w;e.hasEdge(i,a)||(i=r.w,a=r.v);var o=n.node(i),t=n.node(a),f=o,d=!1;o.lim>t.lim&&(f=t,d=!0);var c=u.filter(e.edges(),function(s){return d===Q(n,n.node(s.v),f)&&d!==Q(n,n.node(s.w),f)});return U(c,function(s){return C(e,s)})}function En(n,e,r,i){var a=r.v,o=r.w;n.removeEdge(a,o),n.setEdge(i.v,i.w,{}),z(n),W(n,e),Ie(n,e)}function Ie(n,e){var r=$(n.nodes(),function(a){return!e.node(a).parent}),i=Le(n,r);i=i.slice(1),u.forEach(i,function(a){var o=n.node(a).parent,t=e.edge(a,o),f=!1;t||(t=e.edge(o,a),f=!0),e.node(a).rank=e.node(o).rank+(f?t.minlen:-t.minlen)})}function _e(n,e,r){return n.hasEdge(e,r)}function Q(n,e,r){return r.low<=e.lim&&e.lim<=r.lim}function Ce(n){switch(n.graph().ranker){case"network-simplex":nn(n);break;case"tight-tree":Me(n);break;case"longest-path":Re(n);break;default:nn(n)}}var Re=D;function Me(n){D(n),hn(n)}function nn(n){x(n)}function Te(n){var e=L(n,"root",{},"_root"),r=Oe(n),i=E(u.values(r))-1,a=2*i+1;n.graph().nestingRoot=e,u.forEach(n.edges(),function(t){n.edge(t).minlen*=a});var o=Pe(n)+1;u.forEach(n.children(),function(t){gn(n,e,a,o,i,r,t)}),n.graph().nodeRankFactor=a}function gn(n,e,r,i,a,o,t){var f=n.children(t);if(!f.length){t!==e&&n.setEdge(e,t,{weight:0,minlen:r});return}var d=J(n,"_bt"),c=J(n,"_bb"),s=n.node(t);n.setParent(d,t),s.borderTop=d,n.setParent(c,t),s.borderBottom=c,u.forEach(f,function(h){gn(n,e,r,i,a,o,h);var l=n.node(h),v=l.borderTop?l.borderTop:h,p=l.borderBottom?l.borderBottom:h,b=l.borderTop?i:2*i,N=v!==p?1:a-o[t]+1;n.setEdge(d,v,{weight:b,minlen:N,nestingEdge:!0}),n.setEdge(p,c,{weight:b,minlen:N,nestingEdge:!0})}),n.parent(t)||n.setEdge(e,d,{weight:0,minlen:a+o[t]})}function Oe(n){var e={};function r(i,a){var o=n.children(i);o&&o.length&&u.forEach(o,function(t){r(t,a+1)}),e[i]=a}return u.forEach(n.children(),function(i){r(i,1)}),e}function Pe(n){return u.reduce(n.edges(),function(e,r){return e+n.edge(r).weight},0)}function Fe(n){var e=n.graph();n.removeNode(e.nestingRoot),delete e.nestingRoot,u.forEach(n.edges(),function(r){var i=n.edge(r);i.nestingEdge&&n.removeEdge(r)})}function Se(n,e,r){var i={},a;u.forEach(r,function(o){for(var t=n.parent(o),f,d;t;){if(f=n.parent(t),f?(d=i[f],i[f]=t):(d=a,a=t),d&&d!==t){e.setEdge(d,t);return}t=f}})}function Ae(n,e,r){var i=Ge(n),a=new u.Graph({compound:!0}).setGraph({root:i}).setDefaultNodeLabel(function(o){return n.node(o)});return u.forEach(n.nodes(),function(o){var t=n.node(o),f=n.parent(o);(t.rank===e||t.minRank<=e&&e<=t.maxRank)&&(a.setNode(o),a.setParent(o,f||i),u.forEach(n[r](o),function(d){var c=d.v===o?d.w:d.v,s=a.edge(c,o),h=u.isUndefined(s)?0:s.weight;a.setEdge(c,o,{weight:n.edge(d).weight+h})}),u.has(t,"minRank")&&a.setNode(o,{borderLeft:t.borderLeft[e],borderRight:t.borderRight[e]}))}),a}function Ge(n){for(var e;n.hasNode(e=P("_root")););return e}function Be(n,e){for(var r=0,i=1;i<e.length;++i)r+=Ve(n,e[i-1],e[i]);return r}function Ve(n,e,r){for(var i=Jn(r,m(r,function(c,s){return s})),a=y(m(e,function(c){return R(m(n.outEdges(c),function(s){return{pos:i[s.w],weight:n.edge(s).weight}}),"pos")})),o=1;o<r.length;)o<<=1;var t=2*o-1;o-=1;var f=m(new Array(t),function(){return 0}),d=0;return u.forEach(a.forEach(function(c){var s=c.pos+o;f[s]+=c.weight;for(var h=0;s>0;)s%2&&(h+=f[s+1]),s=s-1>>1,f[s]+=c.weight;d+=c.weight*h})),d}function Ye(n){var e={},r=u.filter(n.nodes(),function(f){return!n.children(f).length}),i=E(m(r,function(f){return n.node(f).rank})),a=m(g(i+1),function(){return[]});function o(f){if(!u.has(e,f)){e[f]=!0;var d=n.node(f);a[d.rank].push(f),u.forEach(n.successors(f),o)}}var t=R(r,function(f){return n.node(f).rank});return u.forEach(t,o),a}function $e(n,e){return m(e,function(r){var i=n.inEdges(r);if(i.length){var a=u.reduce(i,function(o,t){var f=n.edge(t),d=n.node(t.v);return{sum:o.sum+f.weight*d.order,weight:o.weight+f.weight}},{sum:0,weight:0});return{v:r,barycenter:a.sum/a.weight,weight:a.weight}}else return{v:r}})}function qe(n,e){var r={};u.forEach(n,function(a,o){var t=r[a.v]={indegree:0,in:[],out:[],vs:[a.v],i:o};u.isUndefined(a.barycenter)||(t.barycenter=a.barycenter,t.weight=a.weight)}),u.forEach(e.edges(),function(a){var o=r[a.v],t=r[a.w];!u.isUndefined(o)&&!u.isUndefined(t)&&(t.indegree++,o.out.push(r[a.w]))});var i=u.filter(r,function(a){return!a.indegree});return Ue(i)}function Ue(n){var e=[];function r(o){return function(t){t.merged||(u.isUndefined(t.barycenter)||u.isUndefined(o.barycenter)||t.barycenter>=o.barycenter)&&De(o,t)}}function i(o){return function(t){t.in.push(o),--t.indegree===0&&n.push(t)}}for(;n.length;){var a=n.pop();e.push(a),u.forEach(a.in.reverse(),r(a)),u.forEach(a.out,i(a))}return m(u.filter(e,function(o){return!o.merged}),function(o){return _(o,["vs","i","barycenter","weight"])})}function De(n,e){var r=0,i=0;n.weight&&(r+=n.barycenter*n.weight,i+=n.weight),e.weight&&(r+=e.barycenter*e.weight,i+=e.weight),n.vs=e.vs.concat(n.vs),n.barycenter=r/i,n.weight=i,n.i=Math.min(e.i,n.i),e.merged=!0}function We(n,e){var r=de(n,function(s){return u.has(s,"barycenter")}),i=r.lhs,a=R(r.rhs,function(s){return-s.i}),o=[],t=0,f=0,d=0;i.sort(ze(!!e)),d=en(o,a,d),u.forEach(i,function(s){d+=s.vs.length,o.push(s.vs),t+=s.barycenter*s.weight,f+=s.weight,d=en(o,a,d)});var c={vs:y(o)};return f&&(c.barycenter=t/f,c.weight=f),c}function en(n,e,r){for(var i;e.length&&(i=T(e)).i<=r;)e.pop(),n.push(i.vs),r++;return r}function ze(n){return function(e,r){return e.barycenter<r.barycenter?-1:e.barycenter>r.barycenter?1:n?r.i-e.i:e.i-r.i}}function xn(n,e,r,i){var a=n.children(e),o=n.node(e),t=o?o.borderLeft:void 0,f=o?o.borderRight:void 0,d={};t&&(a=u.filter(a,function(p){return p!==t&&p!==f}));var c=$e(n,a);u.forEach(c,function(p){if(n.children(p.v).length){var b=xn(n,p.v,r,i);d[p.v]=b,u.has(b,"barycenter")&&He(p,b)}});var s=qe(c,r);Xe(s,d);var h=We(s,i);if(t&&(h.vs=y([t,h.vs,f]),n.predecessors(t).length)){var l=n.node(n.predecessors(t)[0]),v=n.node(n.predecessors(f)[0]);u.has(h,"barycenter")||(h.barycenter=0,h.weight=0),h.barycenter=(h.barycenter*h.weight+l.order+v.order)/(h.weight+2),h.weight+=2}return h}function Xe(n,e){u.forEach(n,function(r){r.vs=y(r.vs.map(function(i){return e[i]?e[i].vs:i}))})}function He(n,e){u.isUndefined(n.barycenter)?(n.barycenter=e.barycenter,n.weight=e.weight):(n.barycenter=(n.barycenter*n.weight+e.barycenter*e.weight)/(n.weight+e.weight),n.weight+=e.weight)}function je(n){var e=cn(n),r=rn(n,g(1,e+1),"inEdges"),i=rn(n,g(e-1,-1,-1),"outEdges"),a=Ye(n);an(n,a);for(var o=Number.POSITIVE_INFINITY,t,f=0,d=0;d<4;++f,++d){Je(f%2?r:i,f%4>=2),a=F(n);var c=Be(n,a);c<o&&(d=0,t=Rn(a),o=c)}an(n,t)}function rn(n,e,r){return m(e,function(i){return Ae(n,i,r)})}function Je(n,e){var r=new u.Graph;u.forEach(n,function(i){var a=i.graph().root,o=xn(i,a,r,e);u.forEach(o.vs,function(t,f){i.node(t).order=f}),Se(i,r,o.vs)})}function an(n,e){u.forEach(e,function(r){u.forEach(r,function(i,a){n.node(i).order=a})})}function Ke(n){var e=Qe(n);u.forEach(n.graph().dummyChains,function(r){for(var i=n.node(r),a=i.edgeObj,o=Ze(n,e,a.v,a.w),t=o.path,f=o.lca,d=0,c=t[d],s=!0;r!==a.w;){if(i=n.node(r),s){for(;(c=t[d])!==f&&n.node(c).maxRank<i.rank;)d++;c===f&&(s=!1)}if(!s){for(;d<t.length-1&&n.node(c=t[d+1]).minRank<=i.rank;)d++;c=t[d]}n.setParent(r,c),r=n.successors(r)[0]}})}function Ze(n,e,r,i){var a=[],o=[],t=Math.min(e[r].low,e[i].low),f=Math.max(e[r].lim,e[i].lim),d,c;d=r;do d=n.parent(d),a.push(d);while(d&&(e[d].low>t||f>e[d].lim));for(c=d,d=i;(d=n.parent(d))!==c;)o.push(d);return{path:a.concat(o.reverse()),lca:c}}function Qe(n){var e={},r=0;function i(a){var o=r;u.forEach(n.children(a),i),e[a]={low:o,lim:r++}}return u.forEach(n.children(),i),e}function nr(n,e){var r={};function i(a,o){var t=0,f=0,d=a.length,c=T(o);return u.forEach(o,function(s,h){var l=rr(n,s),v=l?n.node(l).order:d;(l||s===c)&&(u.forEach(o.slice(f,h+1),function(p){u.forEach(n.predecessors(p),function(b){var N=n.node(b),X=N.order;(X<t||v<X)&&!(N.dummy&&n.node(p).dummy)&&kn(r,b,p)})}),f=h+1,t=v)}),o}return u.reduce(e,i),r}function er(n,e){var r={};function i(o,t,f,d,c){var s;u.forEach(g(t,f),function(h){s=o[h],n.node(s).dummy&&u.forEach(n.predecessors(s),function(l){var v=n.node(l);v.dummy&&(v.order<d||v.order>c)&&kn(r,l,s)})})}function a(o,t){var f=-1,d,c=0;return u.forEach(t,function(s,h){if(n.node(s).dummy==="border"){var l=n.predecessors(s);l.length&&(d=n.node(l[0]).order,i(t,c,h,f,d),c=h,f=d)}i(t,c,t.length,d,o.length)}),t}return u.reduce(e,a),r}function rr(n,e){if(n.node(e).dummy)return $(n.predecessors(e),function(r){return n.node(r).dummy})}function kn(n,e,r){if(e>r){var i=e;e=r,r=i}var a=n[e];a||(n[e]=a={}),a[r]=!0}function ir(n,e,r){if(e>r){var i=e;e=r,r=i}return u.has(n[e],r)}function ar(n,e,r,i){var a={},o={},t={};return u.forEach(e,function(f){u.forEach(f,function(d,c){a[d]=d,o[d]=d,t[d]=c})}),u.forEach(e,function(f){var d=-1;u.forEach(f,function(c){var s=i(c);if(s.length){s=R(s,function(b){return t[b]});for(var h=(s.length-1)/2,l=Math.floor(h),v=Math.ceil(h);l<=v;++l){var p=s[l];o[c]===c&&d<t[p]&&!ir(r,c,p)&&(o[p]=c,o[c]=a[c]=a[p],d=t[p])}}})}),{root:a,align:o}}function tr(n,e,r,i,a){var o={},t=or(n,e,r,a),f=a?"borderLeft":"borderRight";function d(h,l){for(var v=t.nodes(),p=v.pop(),b={};p;)b[p]?h(p):(b[p]=!0,v.push(p),v=v.concat(l(p))),p=v.pop()}function c(h){o[h]=t.inEdges(h).reduce(function(l,v){return Math.max(l,o[v.v]+t.edge(v))},0)}function s(h){var l=t.outEdges(h).reduce(function(p,b){return Math.min(p,o[b.w]-t.edge(b))},Number.POSITIVE_INFINITY),v=n.node(h);l!==Number.POSITIVE_INFINITY&&v.borderType!==f&&(o[h]=Math.max(o[h],l))}return d(c,t.predecessors.bind(t)),d(s,t.successors.bind(t)),u.forEach(i,function(h){o[h]=o[r[h]]}),o}function or(n,e,r,i){var a=new u.Graph,o=n.graph(),t=sr(o.nodesep,o.edgesep,i);return u.forEach(e,function(f){var d;u.forEach(f,function(c){var s=r[c];if(a.setNode(s),d){var h=r[d],l=a.edge(h,s);a.setEdge(h,s,Math.max(t(n,c,d),l||0))}d=c})}),a}function ur(n,e){return U(u.values(e),function(r){var i=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY;return Fn(r,function(o,t){var f=hr(n,t)/2;i=Math.max(o+f,i),a=Math.min(o-f,a)}),i-a})}function fr(n,e){var r=u.values(e),i=I(r),a=E(r);u.forEach(["u","d"],function(o){u.forEach(["l","r"],function(t){var f=o+t,d=n[f],c;if(d!==e){var s=u.values(d);c=t==="l"?i-I(s):a-E(s),c&&(n[f]=O(d,function(h){return h+c}))}})})}function dr(n,e){return O(n.ul,function(r,i){if(e)return n[e.toLowerCase()][i];var a=R(m(n,i));return(a[1]+a[2])/2})}function cr(n){var e=F(n),r=w.merge(nr(n,e),er(n,e)),i={},a;u.forEach(["u","d"],function(t){a=t==="u"?e:u.values(e).reverse(),u.forEach(["l","r"],function(f){f==="r"&&(a=m(a,function(h){return u.values(h).reverse()}));var d=(t==="u"?n.predecessors:n.successors).bind(n),c=ar(n,a,r,d),s=tr(n,a,c.root,c.align,f==="r");f==="r"&&(s=O(s,function(h){return-h})),i[t+f]=s})});var o=ur(n,i);return fr(i,o),dr(i,n.graph().align)}function sr(n,e,r){return function(i,a,o){var t=i.node(a),f=i.node(o),d=0,c;if(d+=t.width/2,u.has(t,"labelpos"))switch(t.labelpos.toLowerCase()){case"l":c=-t.width/2;break;case"r":c=t.width/2;break}if(c&&(d+=r?c:-c),c=0,d+=(t.dummy?e:n)/2,d+=(f.dummy?e:n)/2,d+=f.width/2,u.has(f,"labelpos"))switch(f.labelpos.toLowerCase()){case"l":c=f.width/2;break;case"r":c=-f.width/2;break}return c&&(d+=r?c:-c),c=0,d}}function hr(n,e){return n.node(e).width}function lr(n){n=dn(n),vr(n),Sn(cr(n),function(e,r){n.node(r).x=e})}function vr(n){var e=F(n),r=n.graph().ranksep,i=0;u.forEach(e,function(a){var o=E(m(a,function(t){return n.node(t).height}));u.forEach(a,function(t){n.node(t).y=i+o/2}),i+=o+r})}function pr(n,e){var r=ce;r("layout",function(){var i=r("  buildLayoutGraph",function(){return Ir(n)});r("  runLayout",function(){wr(i,r)}),r("  updateInputGraph",function(){mr(n,i)})})}function wr(n,e){e("    makeSpaceForEdgeLabels",function(){_r(n)}),e("    removeSelfEdges",function(){Ar(n)}),e("    acyclic",function(){ie(n)}),e("    nestingGraph.run",function(){Te(n)}),e("    rank",function(){Ce(dn(n))}),e("    injectEdgeLabelProxies",function(){Cr(n)}),e("    removeEmptyRanks",function(){fe(n)}),e("    nestingGraph.cleanup",function(){Fe(n)}),e("    normalizeRanks",function(){ue(n)}),e("    assignRankMinMax",function(){Rr(n)}),e("    removeEdgeLabelProxies",function(){Mr(n)}),e("    normalize.run",function(){we(n)}),e("    parentDummyChains",function(){Ke(n)}),e("    addBorderSegments",function(){se(n)}),e("    order",function(){je(n)}),e("    insertSelfEdges",function(){Gr(n)}),e("    adjustCoordinateSystem",function(){he(n)}),e("    position",function(){lr(n)}),e("    positionSelfEdges",function(){Br(n)}),e("    removeBorderNodes",function(){Sr(n)}),e("    normalize.undo",function(){be(n)}),e("    fixupEdgeLabelCoords",function(){Pr(n)}),e("    undoCoordinateSystem",function(){le(n)}),e("    translateGraph",function(){Tr(n)}),e("    assignNodeIntersects",function(){Or(n)}),e("    reversePoints",function(){Fr(n)}),e("    acyclic.undo",function(){te(n)})}function mr(n,e){u.forEach(n.nodes(),function(r){var i=n.node(r),a=e.node(r);i&&(i.x=a.x,i.y=a.y,e.children(r).length&&(i.width=a.width,i.height=a.height))}),u.forEach(n.edges(),function(r){var i=n.edge(r),a=e.edge(r);i.points=a.points,u.has(a,"x")&&(i.x=a.x,i.y=a.y)}),n.graph().width=e.graph().width,n.graph().height=e.graph().height}var br=["nodesep","edgesep","ranksep","marginx","marginy"],Er={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},gr=["acyclicer","ranker","rankdir","align"],xr=["width","height"],kr={width:0,height:0},yr=["minlen","weight","width","height","labeloffset"],Lr={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},Nr=["labelpos"];function Ir(n){var e=new u.Graph({multigraph:!0,compound:!0}),r=V(n.graph());return e.setGraph(w.merge({},Er,B(r,br),_(r,gr))),u.forEach(n.nodes(),function(i){var a=V(n.node(i));e.setNode(i,on(B(a,xr),kr)),e.setParent(i,n.parent(i))}),u.forEach(n.edges(),function(i){var a=V(n.edge(i));e.setEdge(i,w.merge({},Lr,B(a,yr),_(a,Nr)))}),e}function _r(n){var e=n.graph();e.ranksep/=2,u.forEach(n.edges(),function(r){var i=n.edge(r);i.minlen*=2,i.labelpos.toLowerCase()!=="c"&&(e.rankdir==="TB"||e.rankdir==="BT"?i.width+=i.labeloffset:i.height+=i.labeloffset)})}function Cr(n){u.forEach(n.edges(),function(e){var r=n.edge(e);if(r.width&&r.height){var i=n.node(e.v),a=n.node(e.w),o={rank:(a.rank-i.rank)/2+i.rank,e};L(n,"edge-proxy",o,"_ep")}})}function Rr(n){var e=0;u.forEach(n.nodes(),function(r){var i=n.node(r);i.borderTop&&(i.minRank=n.node(i.borderTop).rank,i.maxRank=n.node(i.borderBottom).rank,e=E(e,i.maxRank))}),n.graph().maxRank=e}function Mr(n){u.forEach(n.nodes(),function(e){var r=n.node(e);r.dummy==="edge-proxy"&&(n.edge(r.e).labelRank=r.rank,n.removeNode(e))})}function Tr(n){var e=Number.POSITIVE_INFINITY,r=0,i=Number.POSITIVE_INFINITY,a=0,o=n.graph(),t=o.marginx||0,f=o.marginy||0;function d(c){var s=c.x,h=c.y,l=c.width,v=c.height;e=Math.min(e,s-l/2),r=Math.max(r,s+l/2),i=Math.min(i,h-v/2),a=Math.max(a,h+v/2)}u.forEach(n.nodes(),function(c){d(n.node(c))}),u.forEach(n.edges(),function(c){var s=n.edge(c);u.has(s,"x")&&d(s)}),e-=t,i-=f,u.forEach(n.nodes(),function(c){var s=n.node(c);s.x-=e,s.y-=i}),u.forEach(n.edges(),function(c){var s=n.edge(c);u.forEach(s.points,function(h){h.x-=e,h.y-=i}),u.has(s,"x")&&(s.x-=e),u.has(s,"y")&&(s.y-=i)}),o.width=r-e+t,o.height=a-i+f}function Or(n){u.forEach(n.edges(),function(e){var r=n.edge(e),i=n.node(e.v),a=n.node(e.w),o,t;r.points?(o=r.points[0],t=r.points[r.points.length-1]):(r.points=[],o=a,t=i),r.points.unshift(j(i,o)),r.points.push(j(a,t))})}function Pr(n){u.forEach(n.edges(),function(e){var r=n.edge(e);if(u.has(r,"x"))switch((r.labelpos==="l"||r.labelpos==="r")&&(r.width-=r.labeloffset),r.labelpos){case"l":r.x-=r.width/2+r.labeloffset;break;case"r":r.x+=r.width/2+r.labeloffset;break}})}function Fr(n){u.forEach(n.edges(),function(e){var r=n.edge(e);r.reversed&&r.points.reverse()})}function Sr(n){u.forEach(n.nodes(),function(e){if(n.children(e).length){var r=n.node(e),i=n.node(r.borderTop),a=n.node(r.borderBottom),o=n.node(T(r.borderLeft)),t=n.node(T(r.borderRight));r.width=Math.abs(t.x-o.x),r.height=Math.abs(a.y-i.y),r.x=o.x+r.width/2,r.y=i.y+r.height/2}}),u.forEach(n.nodes(),function(e){n.node(e).dummy==="border"&&n.removeNode(e)})}function Ar(n){u.forEach(n.edges(),function(e){if(e.v===e.w){var r=n.node(e.v);r.selfEdges||(r.selfEdges=[]),r.selfEdges.push({e,label:n.edge(e)}),n.removeEdge(e)}})}function Gr(n){var e=F(n);u.forEach(e,function(r){var i=0;u.forEach(r,function(a,o){var t=n.node(a);t.order=o+i,u.forEach(t.selfEdges,function(f){L(n,"selfedge",{width:f.label.width,height:f.label.height,rank:t.rank,order:o+ ++i,e:f.e,label:f.label},"_se")}),delete t.selfEdges})})}function Br(n){u.forEach(n.nodes(),function(e){var r=n.node(e);if(r.dummy==="selfedge"){var i=n.node(r.e.v),a=i.x+i.width/2,o=i.y,t=r.x-a,f=i.height/2;n.setEdge(r.e,r.label),n.removeNode(e),r.label.points=[{x:a+2*t/3,y:o-f},{x:a+5*t/6,y:o-f},{x:a+t,y:o},{x:a+5*t/6,y:o+f},{x:a+2*t/3,y:o+f}],r.label.x=r.x,r.label.y=r.y}})}function B(n,e){return O(_(n,e),Number)}function V(n){var e={};return u.forEach(n,function(r,i){e[i.toLowerCase()]=r}),e}exports.defaults=on;exports.layout=pr;exports.map=m;exports.pick=_;exports.range=g;exports.uniqueId=P;
//# sourceMappingURL=layout-ChCyWgcE.js.map
