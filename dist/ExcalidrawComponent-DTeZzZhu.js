"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("./index-B68OGEr0.js"),o=require("react"),y=require("./ImageResizer-BVftMirr.js"),I=s=>{var d;const r=(d=s==null?void 0:s.firstElementChild)==null?void 0:d.firstElementChild,f=s.getAttribute("viewBox");if(f!=null){const n=f.split(" ");s.setAttribute("width",n[2]),s.setAttribute("height",n[3])}r&&r.tagName==="style"&&r.remove()};function $({elements:s,files:r,imageContainerRef:f,appState:d,rootClassName:n=null,width:u="inherit",height:x="inherit"}){const[l,b]=o.useState(null);o.useEffect(()=>{(async()=>{const i=await e.r9({appState:d,elements:s,files:r});I(i),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("display","block"),b(i)})()},[s,r,d]);const m={};return u!=="inherit"&&(m.width=`${u}px`),x!=="inherit"&&(m.height=`${x}px`),e.jsxRuntimeExports.jsx("div",{ref:p=>{p&&f&&(f.current=p)},className:n??"",style:m,dangerouslySetInnerHTML:{__html:(l==null?void 0:l.outerHTML)??""}})}function z({nodeKey:s,data:r,width:f,height:d}){const[n]=e.o(),u=e.a$1(),[x,l]=o.useState(r==="[]"&&n.isEditable()),b=o.useRef(null),m=o.useRef(null),p=o.useRef(null),[i,S,E]=e.u$1(s),[g,j]=o.useState(!1);o.useEffect(()=>{if(!u){i&&E();return}return e.j(n.registerCommand(e.ae,t=>{const c=m.current,a=t.target;return g?!0:c!==null&&e.fo(a)&&c.contains(a)?(t.shiftKey||E(),S(!i),t.detail>1&&l(!0),!0):!1},e.Ii))},[E,n,i,g,S,u]);const M=o.useCallback(()=>(l(!1),n.update(()=>{const t=e.as(s);t&&t.remove()})),[n,s]),N=(t,c,a)=>n.update(()=>{const R=e.as(s);e.$isExcalidrawNode(R)&&(t&&t.length>0||Object.keys(a).length>0?R.setData(JSON.stringify({appState:c,elements:t,files:a})):R.remove())}),A=()=>{j(!0)},O=(t,c)=>{setTimeout(()=>{j(!1)},200),n.update(()=>{const a=e.as(s);e.$isExcalidrawNode(a)&&(a.setWidth(t),a.setHeight(c))})},k=o.useCallback(()=>{l(!0)},[]),{elements:h=[],files:w={},appState:C={}}=o.useMemo(()=>JSON.parse(r),[r]),v=o.useCallback(()=>{l(!1),h.length===0&&n.update(()=>{const t=e.as(s);t&&t.remove()})},[n,s,h.length]);return e.jsxRuntimeExports.jsxs(e.jsxRuntimeExports.Fragment,{children:[u&&x&&e.jsxRuntimeExports.jsx(e.ExcalidrawModal,{initialElements:h,initialFiles:w,initialAppState:C,isShown:x,onDelete:M,onClose:v,onSave:(t,c,a)=>{N(t,c,a),l(!1)},closeOnClickOutside:!1}),h.length>0&&e.jsxRuntimeExports.jsxs("button",{ref:m,className:`excalidraw-button ${i?"selected":""}`,children:[e.jsxRuntimeExports.jsx($,{imageContainerRef:b,className:"image",elements:h,files:w,appState:C,width:f,height:d}),i&&u&&e.jsxRuntimeExports.jsx("div",{className:"image-edit-button",role:"button",tabIndex:0,onMouseDown:t=>t.preventDefault(),onClick:k}),(i||g)&&u&&e.jsxRuntimeExports.jsx(y.ImageResizer,{buttonRef:p,showCaption:!0,setShowCaption:()=>null,imageRef:b,editor:n,onResizeStart:A,onResizeEnd:O,captionsEnabled:!0})]})]})}exports.default=z;
//# sourceMappingURL=ExcalidrawComponent-DTeZzZhu.js.map
