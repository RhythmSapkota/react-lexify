"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("./index-B68OGEr0.js"),L=require("./LexicalNestedComposer.prod-CsSHcpTz.js"),p=require("react"),N={...t.theme,paragraph:"StickyEditorTheme__paragraph"};function y(m,a){const u=m.style,d=a.rootElementRect,g=d!==null?d.left:0,c=d!==null?d.top:0;u.top=c+a.y+"px",u.left=g+a.x+"px"}function S({x:m,y:a,nodeKey:u,color:d,caption:g}){const[c]=t.o(),l=p.useRef(null),f=p.useRef({isDragging:!1,offsetX:0,offsetY:0,rootElementRect:null,x:0,y:0}),{isCollabActive:C}=t.l$1();p.useEffect(()=>{const e=f.current;e.x=m,e.y=a;const o=l.current;o!==null&&y(o,e)},[m,a]),p.useLayoutEffect(()=>{const e=f.current,o=new ResizeObserver(i=>{for(let r=0;r<i.length;r++){const x=i[r],{target:b}=x;e.rootElementRect=b.getBoundingClientRect();const R=l.current;R!==null&&y(R,e)}}),n=c.registerRootListener((i,r)=>{r!==null&&o.unobserve(r),i!==null&&o.observe(i)}),s=()=>{const i=c.getRootElement(),r=l.current;i!==null&&r!==null&&(e.rootElementRect=i.getBoundingClientRect(),y(r,e))};return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s),n()}},[c]),p.useEffect(()=>{const e=l.current;e!==null&&setTimeout(()=>{e.style.setProperty("transition","top 0.3s ease 0s, left 0.3s ease 0s")},500)},[]);const E=e=>{const o=l.current,n=f.current,s=n.rootElementRect,i=t.Mt(o);o!==null&&n.isDragging&&s!==null&&(n.x=e.pageX/i-n.offsetX-s.left,n.y=e.pageY/i-n.offsetY-s.top,y(o,n))},h=e=>{const o=l.current,n=f.current;o!==null&&(n.isDragging=!1,o.classList.remove("dragging"),c.update(()=>{const s=t.as(u);t.$isStickyNode(s)&&s.setPosition(n.x,n.y)})),document.removeEventListener("pointermove",E),document.removeEventListener("pointerup",h)},k=()=>{c.update(()=>{const e=t.as(u);t.$isStickyNode(e)&&e.remove()})},j=()=>{c.update(()=>{const e=t.as(u);t.$isStickyNode(e)&&e.toggleColor()})},{historyState:v}=t.useSharedHistoryContext();return t.jsxRuntimeExports.jsx("div",{ref:l,className:"sticky-note-container",children:t.jsxRuntimeExports.jsxs("div",{className:`sticky-note ${d}`,onPointerDown:e=>{const o=l.current;if(o==null||e.button===2||e.target!==o.firstChild)return;const n=o,s=f.current;if(n!==null){const{top:i,left:r}=n.getBoundingClientRect(),x=t.Mt(n);s.offsetX=e.clientX/x-r,s.offsetY=e.clientY/x-i,s.isDragging=!0,n.classList.add("dragging"),document.addEventListener("pointermove",E),document.addEventListener("pointerup",h),e.preventDefault()}},children:[t.jsxRuntimeExports.jsx("button",{onClick:k,className:"delete","aria-label":"Delete sticky note",title:"Delete",children:"X"}),t.jsxRuntimeExports.jsx("button",{onClick:j,className:"color","aria-label":"Change sticky note color",title:"Color",children:t.jsxRuntimeExports.jsx("i",{className:"bucket"})}),t.jsxRuntimeExports.jsxs(L.f,{initialEditor:g,initialTheme:N,children:[C?t.jsxRuntimeExports.jsx(t._$1,{id:g.getKey(),providerFactory:t.createWebsocketProvider,shouldBootstrap:!0}):t.jsxRuntimeExports.jsx(t.a$3,{externalHistoryState:v}),t.jsxRuntimeExports.jsx(t.h$2,{contentEditable:t.jsxRuntimeExports.jsx(t.LexicalContentEditable,{placeholder:"What's up?",placeholderClassName:"StickyNode__placeholder",className:"StickyNode__contentEditable"}),ErrorBoundary:t.a$2})]})]})})}exports.default=S;
//# sourceMappingURL=StickyComponent-ScNu4-oW.js.map
