"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("./index-B68OGEr0.js"),D=require("./LexicalNestedComposer.prod-CsSHcpTz.js"),s=require("react"),y=new Set;function P(o){if(!y.has(o))throw new Promise(x=>{const i=new Image;i.src=o,i.onload=()=>{y.add(o),x(null)}})}function L({altText:o,className:x,imageRef:i,src:g,width:r,height:u,position:a}){return P(g),e.jsxRuntimeExports.jsx("img",{className:x||void 0,src:g,alt:o,ref:i,"data-position":a,style:{display:"block",height:u,width:r},draggable:"false"})}function k({activeEditor:o,nodeKey:x,onClose:i}){const r=o.getEditorState().read(()=>e.as(x)),[u,a]=s.useState(r.getAltText()),[h,C]=s.useState(r.getShowCaption()),[E,j]=s.useState(r.getPosition()),f=d=>{C(d.target.checked)},c=d=>{j(d.target.value)},m=()=>{const d={altText:u,position:E,showCaption:h};r&&o.update(()=>{r.update(d)}),i()};return e.jsxRuntimeExports.jsxs(e.jsxRuntimeExports.Fragment,{children:[e.jsxRuntimeExports.jsx("div",{style:{marginBottom:"1em"},children:e.jsxRuntimeExports.jsx(e.TextInput,{label:"Alt Text",placeholder:"Descriptive alternative text",onChange:a,value:u,"data-test-id":"image-modal-alt-text-input"})}),e.jsxRuntimeExports.jsxs(e.Select,{style:{marginBottom:"1em",width:"208px"},value:E,label:"Position",name:"position",id:"position-select",onChange:c,children:[e.jsxRuntimeExports.jsx("option",{value:"left",children:"Left"}),e.jsxRuntimeExports.jsx("option",{value:"right",children:"Right"}),e.jsxRuntimeExports.jsx("option",{value:"full",children:"Full Width"})]}),e.jsxRuntimeExports.jsxs("div",{className:"Input__wrapper",children:[e.jsxRuntimeExports.jsx("input",{id:"caption",type:"checkbox",checked:h,onChange:f}),e.jsxRuntimeExports.jsx("label",{htmlFor:"caption",children:"Show Caption"})]}),e.jsxRuntimeExports.jsx(e.DialogActions,{children:e.jsxRuntimeExports.jsx(e.Button,{"data-test-id":"image-modal-file-upload-btn",onClick:()=>m(),children:"Confirm"})})]})}function T({src:o,altText:x,nodeKey:i,width:g,height:r,showCaption:u,caption:a,position:h}){const[C,E]=e.useModal(),j=s.useRef(null),f=s.useRef(null),[c,m,d]=e.u$1(i),[t]=e.o(),[b,w]=s.useState(null),I=s.useRef(null),S=e.a$1(),v=s.useCallback(l=>{const p=e.Nr(),n=f.current;if(c&&e.ur(p)&&p.getNodes().length===1){if(u)return e.ys(null),l.preventDefault(),a.focus(),!0;if(n!==null&&n!==document.activeElement)return l.preventDefault(),n.focus(),!0}return!1},[a,c,u]),N=s.useCallback(l=>I.current===a||f.current===l.target?(e.ys(null),t.update(()=>{m(!0);const p=t.getRootElement();p!==null&&p.focus()}),!0):!1,[a,t,m]);s.useEffect(()=>{let l=!0;const p=e.j(t.registerUpdateListener(({editorState:n})=>{l&&w(n.read(()=>e.Nr()))}),t.registerCommand(e.le,(n,R)=>(I.current=R,!1),e.Ii),t.registerCommand(e.ae,n=>{const R=n;return R.target===j.current?(R.shiftKey?m(!c):(d(),m(!0)),!0):!1},e.Ii),t.registerCommand(e.Be,n=>n.target===j.current?(n.preventDefault(),!0):!1,e.Ii),t.registerCommand(e.Ee,v,e.Ii),t.registerCommand(e.Oe,N,e.Ii));return()=>{l=!1,p()}},[d,t,c,i,v,N,m]);const _=c&&e.ur(b),$=c&&S;return e.jsxRuntimeExports.jsxs(s.Suspense,{fallback:null,children:[e.jsxRuntimeExports.jsxs(e.jsxRuntimeExports.Fragment,{children:[e.jsxRuntimeExports.jsxs("span",{draggable:_,children:[S&&e.jsxRuntimeExports.jsx("button",{className:"image-edit-button",ref:f,onClick:()=>{E("Update Inline Image",l=>e.jsxRuntimeExports.jsx(k,{activeEditor:t,nodeKey:i,onClose:l}))},children:"Edit"}),e.jsxRuntimeExports.jsx(L,{className:$?`focused ${e.ur(b)?"draggable":""}`:null,src:o,altText:x,imageRef:j,width:g,height:r,position:h})]}),u&&e.jsxRuntimeExports.jsx("span",{className:"image-caption-container",children:e.jsxRuntimeExports.jsxs(D.f,{initialEditor:a,children:[e.jsxRuntimeExports.jsx(e.o$1,{}),e.jsxRuntimeExports.jsx(e.LinkPlugin,{}),e.jsxRuntimeExports.jsx(e.h$1,{contentEditable:e.jsxRuntimeExports.jsx(e.LexicalContentEditable,{placeholder:"Enter a caption...",placeholderClassName:"InlineImageNode__placeholder",className:"InlineImageNode__contentEditable"}),ErrorBoundary:e.a$2})]})})]}),C]})}exports.UpdateInlineImageDialog=k;exports.default=T;
//# sourceMappingURL=InlineImageComponent-BqPij8mU.js.map
