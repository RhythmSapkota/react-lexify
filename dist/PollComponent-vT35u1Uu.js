"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("./index-B68OGEr0.js"),m=require("react");function v(o){return o.reduce((n,l)=>n+l.votes.length,0)}function R({option:o,index:n,options:l,totalVotes:r,withPollNode:x}){const{clientID:a}=e.l$1(),j=m.useRef(null),p=o.votes,h=p.indexOf(a)!==-1,c=p.length,_=o.text;return e.jsxRuntimeExports.jsxs("div",{className:"PollNode__optionContainer",children:[e.jsxRuntimeExports.jsx("div",{className:e.joinClasses("PollNode__optionCheckboxWrapper",h&&"PollNode__optionCheckboxChecked"),children:e.jsxRuntimeExports.jsx("input",{ref:j,className:"PollNode__optionCheckbox",type:"checkbox",onChange:d=>{x(s=>{s.toggleVote(o,a)})},checked:h})}),e.jsxRuntimeExports.jsxs("div",{className:"PollNode__optionInputWrapper",children:[e.jsxRuntimeExports.jsx("div",{className:"PollNode__optionInputVotes",style:{width:`${c===0?0:c/r*100}%`}}),e.jsxRuntimeExports.jsx("span",{className:"PollNode__optionInputVotesCount",children:c>0&&(c===1?"1 vote":`${c} votes`)}),e.jsxRuntimeExports.jsx("input",{className:"PollNode__optionInput",type:"text",value:_,onChange:d=>{const s=d.target,t=s.value,i=s.selectionStart,u=s.selectionEnd;x(f=>{f.setOptionText(o,t)},()=>{s.selectionStart=i,s.selectionEnd=u})},placeholder:`Option ${n+1}`})]}),e.jsxRuntimeExports.jsx("button",{disabled:l.length<3,className:e.joinClasses("PollNode__optionDelete",l.length<3&&"PollNode__optionDeleteDisabled"),"aria-label":"Remove",onClick:()=>{x(d=>{d.deleteOption(o)})}})]})}function E({question:o,options:n,nodeKey:l}){const[r]=e.o(),x=m.useMemo(()=>v(n),[n]),[a,j,p]=e.u$1(l),[N,h]=m.useState(null),c=m.useRef(null);m.useEffect(()=>e.j(r.registerUpdateListener(({editorState:t})=>{h(t.read(()=>e.Nr()))}),r.registerCommand(e.ae,t=>{const i=t;return i.target===c.current?(i.shiftKey||p(),j(!a),!0):!1},e.Ii)),[p,r,a,l,j]);const _=(t,i)=>{r.update(()=>{const u=e.as(l);e.$isPollNode(u)&&t(u)},{onUpdate:i})},d=()=>{_(t=>{t.addOption(e.createPollOption())})},s=e.ur(N)&&a;return e.jsxRuntimeExports.jsx("div",{className:`PollNode__container ${s?"focused":""}`,ref:c,children:e.jsxRuntimeExports.jsxs("div",{className:"PollNode__inner",children:[e.jsxRuntimeExports.jsx("h2",{className:"PollNode__heading",children:o}),n.map((t,i)=>{const u=t.uid;return e.jsxRuntimeExports.jsx(R,{withPollNode:_,option:t,index:i,options:n,totalVotes:x},u)}),e.jsxRuntimeExports.jsx("div",{className:"PollNode__footer",children:e.jsxRuntimeExports.jsx(e.Button,{onClick:d,small:!0,children:"Add Option"})})]})})}exports.default=E;
//# sourceMappingURL=PollComponent-vT35u1Uu.js.map
